<!doctype html>
<html lang="en">
  <head>
   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
   <meta http-equiv="X-UA-Compatible" content="ie=edge" />
   <title>Monitoring Tempat Sampah</title>

   <!-- Load hanya CSS utama, hapus yang tidak dipakai untuk meringankan -->
   <link href="../static/dist/css/tabler.min.css" rel="stylesheet" />
  <link href="../static/dist/css/demo.min.css" rel="stylesheet" />
  <link rel="icon" type="image/jpg" href="../static/images/logo.png" sizes="24x24">
      
  <!-- Font styling -->
   <style>
    @import url('https://rsms.me/inter/inter.css');
     :root {
      --tblr-font-sans-serif: 'Inter Var', -apple-system, BlinkMacSystemFont, San Francisco, Segoe UI, Roboto, Helvetica Neue, sans-serif;
      }
      body {font-feature-settings: "cv03", "cv04", "cv11";  }

      /* Footer fixed di kanan bawah */
     .custom-footer {
      position: fixed;
      bottom: 30px;
      right: 20px;
         font-size: 14px;
         color:rgb(114, 114, 120);
         z-index: 9999;
         }
      </style>

      <style>
         .trash-can {
         width: 100px;
         height: 150px;
         background-color: #2e2e2e;
         border: 2px solid rgb(81, 181, 18);
         border-radius: 10px 10px 0 0;
         position: relative;
         margin: 10px auto;
         overflow: hidden;
         }
         .trash-lid {
         width: 120px;
         height: 20px;
         background-color: #ccc;
         position: absolute;
         top: -20px;
         left: -10px;
         border-radius: 5px 5px 0 0;
         z-index: 1;
         }
         .trash-level {
         background-color: #3498db;
         height: 0;
         width: 100%;
         position: absolute;
         bottom: 0;
         transition: height 0.5s ease-in-out;
         }
         .status-indicator {
         width: 100%;
         height: 20px;
         margin-top: 10px;
         }
      </style>

      <style>
      /* Ubah warna teks sidebar */
         .navbar .nav-link-title {
          color: rgb(195, 199, 185) !important;
         }
      </style>
      </head>

   <body>
      <!-- Tema dan struktur utama -->
      <script src="../static/dist/js/demo-theme.min.js"></script>
      <div class="page">
      <!-- ================= Sidebar ================= -->
      <aside class="navbar navbar-vertical navbar-expand-lg" style="background-color:rgb(43, 70, 28);">
         <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar-menu"
               aria-controls="sidebar-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            </button>
            <h1 class="navbar-brand navbar-brand-autodark">
               <a href="../website/index.html">
               <img src="../static/images/logo.png" style="width: 80px; height: auto;" alt="Logo" class="navbar-brand-image">
               </a>
            </h1>
            <!-- ===== Navigasi Menu Sidebar ===== -->
            <div class="collapse navbar-collapse" id="sidebar-menu">
               <ul class="navbar-nav pt-lg-3">
                  <!-- Menu Sidebar -->
                  <li class="nav-item">
                     <a class="nav-link" href="../website/about.html">
                        <span class="nav-link-icon d-md-none d-lg-inline-block">
                           <!-- Ikon About -->
                           <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-user-question">
                              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                              <path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" />
                              <path d="M6 21v-2a4 4 0 0 1 4 -4h3.5" />
                              <path d="M19 22v.01" />
                              <path d="M19 19a2.003 2.003 0 0 0 .914 -3.782a1.98 1.98 0 0 0 -2.414 .483" />
                           </svg>
                        </span>
                        <span class="nav-link-title">About</span>
                     </a>
                  </li>

                  <li class="nav-item">
                     <a class="nav-link" href="../website/index.html">
                        <span
                           class="nav-link-icon d-md-none d-lg-inline-block">
                           <!-- Ikon Monitoring -->
                           <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-heart-rate-monitor">
                              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                              <path d="M3 4m0 1a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1z" />
                              <path d="M7 20h10" />
                              <path d="M9 16v4" />
                              <path d="M15 16v4" />
                              <path d="M7 10h2l2 3l2 -6l1 3h3" />
                           </svg>
                        </span>
                        <span class="nav-link-title">Monitoring</span>
                     </a>
                  </li>
               </ul>
            </div>
         </div>
      </aside>

      <!-- ================= Konten Utama ================= -->
      <div class="page-wrapper">
      <div class="page-body">
      <div class="container-xl">
      <div class="row justify-content-left">
      <div class="col-lg-11 col-xl-11">
      <div class="card card-lg">
      <div class="card-body markdown">
      <!-- Page header -->
      <div class="page-header d-print-none">
         <div class="container-xl">
            <div class="row g-2 align-items-center">
               <div class="col">
                  <!-- Page pre-title -->
                  <div class="page-pretitle">Overview</div>
                  <h2 class="page-title">Monitoring Tempat Sampah</h2>
               </div>
            </div>
         </div>
      </div>

      <div class="row row-cards">
         <div class="col-md-6">
            <div class="card text-black mb-4" style="background-color:rgb(195, 199, 185);">
               <div class="card-header">Tempat Sampah 1</div>
               <div class="card-body">
                  <h4>Volume: <span id="trashStatus1">Loading...</span></h4>
                  <div class="trash-can">
                     <div class="trash-lid"></div>
                     <div class="trash-level" id="trashLevel1"></div>
                  </div>
                  <h4>Berat: <span id="weightStatus1">Loading...</span></h4>
                  <h4>Gas: <span id="gasStatus1">Loading...</span></h4>
                  <div id="gasIndicator1" class="status-indicator"></div>
               </div>
            </div>
         </div>
         <div class="col-md-6">
            <div class="card text-black mb-4" style="background-color:rgb(195, 199, 185);">
               <div class="card-header">Tempat Sampah 2</div>
               <div class="card-body">
                  <h4>Volume: <span id="trashStatus2">Loading...</span></h4>
                  <div class="trash-can">
                     <div class="trash-lid"></div>
                     <div class="trash-level" id="trashLevel2"></div>
                  </div>
                  <h4>Berat: <span id="weightStatus2">Loading...</span></h4>
                  <h4>Gas: <span id="gasStatus2">Loading...</span></h4>
                  <div id="gasIndicator2" class="status-indicator"></div>
               </div>
            </div>
         </div>
      </div>

      <!-- Tombol Reset -->
      <div class="text-center mt-4">
          <button onclick="resetData()" class="btn btn-danger">Reset Data</button>
      </div>

      <!-- Footer kanan bawah -->
      <footer class="custom-footer">
         <ul class="list-inline list-inline-dots mb-0">
            <li class="list-inline-item">
               Copyright &copy; 2025
               <a href="#" class="link-secondary">Monitoring Tempat Sampah</a>.
               Istianah (3332210010)
            </li>
         </ul>
      </footer>

      <!-- Libs JS -->
      <script src="../static/dist/libs/apexcharts/dist/apexcharts.min.js" defer></script>
      <script src="../static/dist/libs/jsvectormap/dist/js/jsvectormap.min.js" defer></script>
      <script src="../static/dist/libs/jsvectormap/dist/maps/world.js" defer></script>
      <script src="../static/dist/libs/jsvectormap/dist/maps/world-merc.js" defer></script>
      <script src="../static/dist/js/tabler.min.js" defer></script>
      <script src="../static/dist/js/demo.min.js" defer></script>

      <!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script>
   // Konfigurasi Firebase
   var firebaseConfig = {
     apiKey: "AIzaSyBMsqV-LSOI0kdsPjPrIW0WU1SO06wHHoU",
     authDomain: "monitoring-tempat-sampah-52c13.firebaseapp.com",
     databaseURL: "https://monitoring-tempat-sampah-52c13-default-rtdb.asia-southeast1.firebasedatabase.app",
     projectId: "monitoring-tempat-sampah-52c13",
     storageBucket: "monitoring-tempat-sampah-52c13.firebasestorage.app",
     messagingSenderId: "589651956692",
     appId: "1:589651956692:web:c26dffa19a84501862fc41",
     measurementId: "G-BVEBFBGKDN"
   };
   firebase.initializeApp(firebaseConfig);

   // Fungsi update visual tempat sampah
   function updateTrashVisual(id, value) {
     const status = document.getElementById("trashStatus" + id);
     const level = document.getElementById("trashLevel" + id);
     if (status && level) {
       status.innerText = value.toFixed(1) + "%";
       level.style.height = value + "%";

       if (value < 50) {
         level.style.backgroundColor = "#2ecc71"; // Hijau
       } else if (value < 80) {
         level.style.backgroundColor = "#f39c12"; // Oranye
       } else {
         level.style.backgroundColor = "#e74c3c"; // Merah
       }
     }
   }

   // Update volume dari Firebase
   firebase.database().ref("/TS1/VOLUME_PERSEN").on("value", function(snapshot) {
     const value = snapshot.val();
     updateTrashVisual("1", value);
   });

   firebase.database().ref("/TS2/VOLUME_PERSEN").on("value", function(snapshot) {
     const value = snapshot.val();
     updateTrashVisual("2", value);
   });

   // Update gas MQ2
   firebase.database().ref("/TS1/MQ2_PPM").on("value", function(snapshot) {
     const ppm = snapshot.val();
     document.getElementById("gasStatus1").innerText = ppm.toFixed(1) + " ppm";
     document.getElementById("gasIndicator1").style.backgroundColor = ppm <= 1000 ? "green" : "red";
   });

   firebase.database().ref("/TS2/MQ2_PPM").on("value", function(snapshot) {
     const ppm = snapshot.val();
     document.getElementById("gasStatus2").innerText = ppm.toFixed(1) + " ppm";
     document.getElementById("gasIndicator2").style.backgroundColor = ppm <= 1000 ? "green" : "red";
   });

   // Update berat load cell
   firebase.database().ref("/TS1/LOAD_CELL_WEIGHT").on("value", function(snapshot) {
     const berat = snapshot.val();
     document.getElementById("weightStatus1").innerText = berat.toFixed(1) + " gram";
   });

   firebase.database().ref("/TS2/LOAD_CELL_WEIGHT").on("value", function(snapshot) {
     const berat = snapshot.val();
     document.getElementById("weightStatus2").innerText = berat.toFixed(1) + " gram";
   });

   // Fungsi reset
   function resetData() {
     document.getElementById("trashStatus1").innerText = "Loading...";
     document.getElementById("trashStatus2").innerText = "Loading...";
     document.getElementById("trashLevel1").style.height = "0%";
     document.getElementById("trashLevel2").style.height = "0%";
     document.getElementById("weightStatus1").innerText = "Loading...";
     document.getElementById("weightStatus2").innerText = "Loading...";
     document.getElementById("gasStatus1").innerText = "Loading...";
     document.getElementById("gasStatus2").innerText = "Loading...";
     document.getElementById("gasIndicator1").style.backgroundColor = "transparent";
     document.getElementById("gasIndicator2").style.backgroundColor = "transparent";

     firebase.database().ref("/TS1").update({
       VOLUME_PERSEN: 0,
       LOAD_CELL_WEIGHT: 0,
       MQ2_PPM: 0
     });
     firebase.database().ref("/TS2").update({
       VOLUME_PERSEN: 0,
       LOAD_CELL_WEIGHT: 0,
       MQ2_PPM: 0
     });
   }
</script>
</body>
